<div id="guest_general_informations" x-data="{ showForm: false, openMoreInfos: false }">
  <!-- EDIT BUTTON -->
  <button 
    :class="showForm ? 'bg-yellow-500 hover:bg-yellow-700' : 'bg-blue-500 hover:bg-blue-700'"
    class="text-white font-bold py-2 px-4 rounded"
    @click="showForm = !showForm">
    <span x-text="showForm ? 'CANCEL' : 'EDIT'"></span>
  </button>
  <%= form_for @guest, url: guest_path(@guest), method: :put, html: { multipart: true, data: { controller: "photo-preview" }, class: "space-y-6" } do |form| %>
    <!-- GUEST CARES -->
    <div class="guest-cares">
      METTRE DES TAGS SOINS SELON TRANSACTIONS
    </div>
    <!-- GUEST MAIN INFO -->
    <div class="guest-main-info flex flex-row">
      <div class="left mr-5">
        <% if @guest.photo.attached? %>
          <%= cl_image_tag @guest.photo.key, quality: "auto", height: 150, width: 150, crop: :thumb, gravity: :face, class: "rounded-full" %>
        <% else %>
          <%= image_tag "guest/guest_photo_profil.png", quality: "auto", height: 150, width: 150, crop: :thumb, class: "rounded-full bg-tomato" %>
        <% end %>
        <label for="photo" class="hidden text-lg font-medium text-gray-700">
          <%= t("form.labels.guest.photo") %>
        </label>
        <input type="file" id="photo" name="guest[photo]" accept="image/jpeg, image/png" class="hidden block mt-2" data-edit-guest-target="photo" />
      </div>
      <div class="right w-full">
        <div x-show="!showForm">
          <p class="text-3xl font-bold mt-5 mb-5">
            <%= @guest.full_name %>
          </p>
        </div>
        <div x-show="showForm">
          <%= field(form, :firstname) %>
        </div>
        <div x-show="showForm">
          <%= field(form, :name) %>
        </div>
        <div x-show="!showForm">
          <p class="flex items-center">
            <%= raw(File.read(Rails.root.join('app', 'assets', 'svg', 'email.svg')).gsub('<svg', '<svg class="w-6 h-6 text-customPink mr-1"')) %>
            <%= mail_to @guest.email, @guest.email, class: "text-customPink hover:underline" %>
          </p>
        </div>
        <div x-show="showForm">
          <%= field(form, :email) %>
        </div>
        <div x-show="!showForm" >
          <p class="flex items-center mb-2">
            <%= raw(File.read(Rails.root.join('app', 'assets', 'svg', 'phone.svg')).gsub('<svg', '<svg class="w-6 h-6 text-customPink mr-1"')) %>
            <%= link_to @guest.phone, "tel:#{@guest.phone}", class: "text-customPink hover:underline" %>
          </p>
        </div>
        <div x-show="showForm">
          <%= field(form, :phone) %>
        </div>
      </div>
    </div>
    <!-- MORE INFOS BUTTON -->
    <div x-data="{ openMoreInfos: false }">
      <button type="button" @click="openMoreInfos = !openMoreInfos" class="flex flex-col justify-center items-center text-black hover:text-customPink">
        + more infos
      </button>
      <!-- MORE INFOS CONTENT -->
      <div x-show="openMoreInfos" x-transition x-cloak class="z-40 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 text-sm bg-white p-2 mt-2">
        <div class="py-1">
          <div class="guest-secondary-info">
            <div x-show="!showForm" >
              <p>
                <strong><%= t(".address") %></strong> <%= @guest.address %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :address) %>
            </div>
            <div x-show="!showForm" >
              <p >
                <strong><%= t(".zip_code") %></strong> <%= @guest.zip_code %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :zip_code) %>
            </div>
            <div x-show="!showForm" >
              <p >
                <strong><%= t(".city") %></strong> <%= @guest.city %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :city) %>
            </div>
            <div x-show="!showForm" >
              <p>
                <strong><%= t(".country") %></strong> <%= @guest.country %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :country) %>
            </div>
            <div x-show="!showForm">
              <p class="flex items-center mb-2">
                <strong><%= t(".birthdate") %></strong> <%= @guest.birthdate %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :birthdate) %>
            </div>
            <div x-show="showForm">
              <%= field(form, :how_do_you_know_us) %>
            </div>
            <div x-show="showForm">
              <%= field(form, :how_do_you_know_us) %>
            </div>
            <div>
              <p>
                <strong><%= t(".notes") %></strong> <%= @guest.notes %>
              </p>
            </div>
            <div x-show="showForm">
              <%= field(form, :notes) %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- GUEST SUBMIT BUTTON -->
    <div x-show="showForm">
      <button type="submit" class="mt-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
        SUBMIT BUTTON
      </button>
    </div>
  <% end %>
</div>
